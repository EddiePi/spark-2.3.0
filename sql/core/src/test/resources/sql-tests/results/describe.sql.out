-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 31


-- !query 0
CREATE TABLE t (a STRING, b INT, c STRING, d STRING) USING parquet
  PARTITIONED BY (c, d) CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
  COMMENT 'table_comment'
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE TEMPORARY VIEW temp_v AS SELECT * FROM t
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
CREATE TEMPORARY VIEW temp_Data_Source_View
  USING org.apache.spark.sql.sources.DDLScanSource
  OPTIONS (
    From '1',
    To '10',
    Table 'test1')
-- !query 2 schema
struct<>
-- !query 2 output



-- !query 3
CREATE VIEW v AS SELECT * FROM t
-- !query 3 schema
struct<>
-- !query 3 output



-- !query 4
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
DESCRIBE t
-- !query 5 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 5 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 6
DESC default.t
-- !query 6 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 6 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 7
DESC TABLE t
-- !query 7 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 7 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 8
DESC FORMATTED t
-- !query 8 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 8 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created [not included in comparison]
Last Access [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Partition Provider  	Catalog


-- !query 9
DESC EXTENDED t
-- !query 9 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 9 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created [not included in comparison]
Last Access [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Location [not included in comparison]sql/core/spark-warehouse/t	                    
Partition Provider  	Catalog


-- !query 10
DESC t PARTITION (c='Us', d=1)
-- !query 10 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 10 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query 11
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query 11 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 11 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]sql/core/spark-warehouse/t/c=Us/d=1	                    
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 12
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query 12 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 12 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]sql/core/spark-warehouse/t/c=Us/d=1	                    
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]sql/core/spark-warehouse/t


-- !query 13
DESC t PARTITION (c='Us', d=2)
-- !query 13 schema
struct<>
-- !query 13 output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 't' database 'default':
c -> Us
d -> 2;


-- !query 14
DESC t PARTITION (c='Us')
-- !query 14 schema
struct<>
-- !query 14 output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`default`.`t`';


-- !query 15
DESC t PARTITION (c='Us', d)
-- !query 15 schema
struct<>
-- !query 15 output
org.apache.spark.sql.catalyst.parser.ParseException

PARTITION specification is incomplete: `d`(line 1, pos 0)

== SQL ==
DESC t PARTITION (c='Us', d)
^^^


-- !query 16
DESC temp_v
-- !query 16 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 16 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 17
DESC TABLE temp_v
-- !query 17 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 17 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 18
DESC FORMATTED temp_v
-- !query 18 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 18 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 19
DESC EXTENDED temp_v
-- !query 19 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 19 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 20
DESC temp_Data_Source_View
-- !query 20 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 20 output
# col_name          	data_type           	comment             
intType             	int                 	test comment test1  
stringType          	string              	                    
dateType            	date                	                    
timestampType       	timestamp           	                    
doubleType          	double              	                    
bigintType          	bigint              	                    
tinyintType         	tinyint             	                    
decimalType         	decimal(10,0)       	                    
fixedDecimalType    	decimal(5,1)        	                    
binaryType          	binary              	                    
booleanType         	boolean             	                    
smallIntType        	smallint            	                    
floatType           	float               	                    
mapType             	map<string,string>  	                    
arrayType           	array<string>       	                    
structType          	struct<f1:string,f2:int>


-- !query 21
DESC temp_v PARTITION (c='Us', d=1)
-- !query 21 schema
struct<>
-- !query 21 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a temporary view: temp_v;


-- !query 22
DESC v
-- !query 22 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 22 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 23
DESC TABLE v
-- !query 23 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 23 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query 24
DESC FORMATTED v
-- !query 24 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 24 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created [not included in comparison]
Last Access [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Properties          	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]


-- !query 25
DESC EXTENDED v
-- !query 25 schema
struct<col_name:string,data_type:string,comment:string>
-- !query 25 output
# col_name          	data_type           	comment             
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created [not included in comparison]
Last Access [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Default Database	default             	                    
View Query Output Columns	[a, b, c, d]        	                    
Properties          	[view.query.out.col.3=d, view.query.out.col.0=a, view.query.out.numCols=4, view.default.database=default, view.query.out.col.1=b, view.query.out.col.2=c]


-- !query 26
DESC v PARTITION (c='Us', d=1)
-- !query 26 schema
struct<>
-- !query 26 output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a view: v;


-- !query 27
DROP TABLE t
-- !query 27 schema
struct<>
-- !query 27 output



-- !query 28
DROP VIEW temp_v
-- !query 28 schema
struct<>
-- !query 28 output



-- !query 29
DROP VIEW temp_Data_Source_View
-- !query 29 schema
struct<>
-- !query 29 output



-- !query 30
DROP VIEW v
-- !query 30 schema
struct<>
-- !query 30 output

